<div class="container">
  <div class="row">
      <div class="col-sm-1">
      </div>
      <div class="col-sm-4">
        <%= cl_image_tag(@user.profile_image_path, gravity:"faces", crop:"fill", class:"profile-picture") %>
      </div>
      <div class="col-sm-6 catch-paragraph-left">
        <%= @user.first_name %>
        <!-- if user is available show "search button" -->
          <% if @user.available %>
            <% if @user.user_adjectives.present? %>
              looking for someone who is <%= @user.user_adjectives.first[:adjective] %>, <%= @user.user_adjectives.first[:adjective_2] %> and <%= @user.user_adjectives.first[:adjective_3] %>
            <%= link_to "edit my search...", edit_user_user_adjective_path(@user, @user.user_adjective_ids.first), class:"small_link_text_right"  %>
              <% else %>
              <%= link_to "my search", new_user_user_adjective_path(@user, @user.user_adjective_ids.first), class:"main_action_button mt-3"  %>
            <% end %>
          <% end %>
        <%= link_to edit_user_registration_path(@user), class:"small_link_text_right" do %>
          edit my profile...
          <% end %>
      </div>
      <div class="col-sm-1">
      </div>
  </div>
</div>

<div>
  <% unless @invitations.nil? %>
    <% @invitations.each do |invitation| %>
      <% if invitation.accepted.nil? %>
        <p><%= invitation.user.full_name %> has invited you as a trusted friend</p>
        <%= link_to "Accept invitation",friend_invitation_path(invitation, friend_invitation: {accepted: true}), method: :put, class:"second_action_button mr-3" %>
        <%= link_to friend_invitation_path(invitation, friend_invitation: {accepted: false}), method: :put do %>
          <i class="fas fa-trash-alt"></i>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>


<div class="p-3">
  <% if @user.available %>
    <h2>Friends helping with your search</h2>
    <% else %>
    <h2>Friends you are helping in their search</h2>
  <% end %>

  <div class="cards">
  <!-- accepted friends -->
    <% @accepted_invitations.each do |invitation| %>
      <% if invitation.friend == @user %>
        <% myfriend = invitation.user %>
      <% else %>
        <% myfriend = invitation.friend %>
      <% end %>
      <%= link_to user_path(myfriend), class:"text-decoration-none" do %>
        <div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= myfriend.profile_image_path %>')">
          <p><%= myfriend.full_name %></p>
        </div>
      <% end %>
    <% end %>
  <!-- pending friends -->
  <% @pending_invitations.each do |invitation| %>
    <% myfriend = invitation.friend %>
    <%= link_to user_path(myfriend), class:"text-decoration-none" do %>
      <div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= myfriend.profile_image_path %>')">
         <%= myfriend.full_name %> <i class="fas fa-frog"></i>
      </div>
    <% end %>
  <% end %>
</div>

<div align="center">
  <% if @user.available %>
    <%= link_to "broaden your opportunities by inviting more friends to help you", new_friend_invitation_path, class:"main_action_button mt-3"  %>
  <% else %>
    <%= link_to "help other friends by inviting them", new_friend_invitation_path, class:"main_action_button mt-3"  %>
  <% end %>
</div>

<!-- if user is available show matches profiles -->
<% if @user.available %>
  <div class="p-3 my-3">
    <h2>My Matches</h2>
    <%= render 'mymatches', matches: @matches  %>
    <% unless @pending_matches.nil? %>
    <%= render 'mymatches', matches: @pending_matches  %>
    <% end %>
  </div>
<!-- if user is not available show submitted matches with both profiles and status -->
<% else %>
  <div class="p-3 my-3">
    <% if @helper_matches.nil? %>
      <p>Create your first match today! </p>
    <% else %>
      <h2>My submitted Matches</h2>
      <%= render 'helper_matches' %>
    <% end %>
  </div>
<% end %>
